parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Focm":[function(require,module,exports) {
"use strict";var e,t,n,o,r,i,a,c=s(require("./math.rs"));function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=o?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}var h="TriangleStripDrawMode",E="drawMode: ",y=document.createElement("button");y.style.fontFamily="monospace",y.style.fontSize="2em",y.style.backgroundColor="#2EAFAC",y.style.border="1px solid black",y.style.position="absolute",y.style.top=0,y.style.right=0,y.style.zIndex=1,y.innerText="".concat(E).concat(h),y.onclick=function(e){h="TriangleStripDrawMode"==h?"TrianglesDrawMode":"TriangleStripDrawMode",y.innerText="".concat(E).concat(h)};var w={isWireframe:!1,applyVelocityMult:!0,drawSpheres:!1},f=new dat.GUI,v=Object.keys(w);for(var m in v)f.add(w,v[m]);var T={x:0,y:0};function g(e,t){return Math.random()*(t-e)+e}var R=[],H=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new THREE.Vector3(0,0,0);u(this,e),this.vx=5e-5*g(-1,1),this.vy=5e-5*g(-2,2),this.alpha=255;var n=new THREE.BoxGeometry(1,1,1),o=new THREE.MeshBasicMaterial({color:3059628,transparent:!0}),r=new THREE.Mesh(n,o);r.scale.multiplyScalar(.005),r.position.add(t.clone()),this.cube=r,i.add(r)}return p(e,[{key:"finished",value:function(){return this.alpha<0}},{key:"update",value:function(){this.cube.position.x=c.add(this.vx,this.cube.position.x),this.cube.position.y=c.add(this.vy,this.cube.position.y),this.alpha=c.subtract(this.alpha,.5),this.cube.rotation.x=c.add(this.cube.rotation.x,.1),this.cube.rotation.y=c.add(this.cube.rotation.y,.1),this.cube.material.opacity=c.multiply(this.alpha,.00392156863)}}]),e}();function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new THREE.Vector3(0,0,0);if(F){var t=new H(e);R.push(t)}for(var n=R.length-1;n>=0;n--)R[n].update(),R[n].finished()&&(i.remove(R[n]),console.log("removed??",R.length,i.children.length),R.splice(n,1))}var V,x=.001,M=2,S=2,A=.1,z=.05,P=.00125,O=.1,j=1.25,B=.5,C=.5,W=.5,k=.95,D=.5,L=.005,U=15,F=!1,q=[],G=[],Q=0,I=[],_=[],X=new THREE.RawShaderMaterial({vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShader").textContent,side:THREE.DoubleSide,transparent:!0});function Y(){(a=new THREE.WebGLRenderer({alpha:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.autoClear=!1,o=a.domElement,document.body.appendChild(o),i=new THREE.Scene,n=new THREE.ARView(e,a),r=new THREE.ARPerspectiveCamera(e,60,window.innerWidth/window.innerHeight,.01,100),t=new THREE.VRControls(r),window.addEventListener("resize",me,!1),a.domElement.addEventListener("touchstart",function(e){F=!0}),a.domElement.addEventListener("touchend",function(e){F=!1,q.length=0,Q+=1}),a.domElement.addEventListener("touchmove",function(e){T={x:e.changedTouches[0].pageX/document.body.clientWidth,y:e.changedTouches[0].pageY/document.body.clientHeight},document.querySelector("#info").innerHTML="".concat(T.x," \n ").concat(T.y)});var c=new THREE.PointLight(16711680,1,100);c.position.set(0,0,0),i.add(c),ve()}THREE.ARUtils.getARDisplay().then(function(t){t?(e=t,Y()):THREE.ARUtils.displayUnsupportedMessage()});var J=function(){var e=new THREE.Vector3(0,0,-1).multiplyScalar(A),t=new THREE.Vector3,n=new THREE.Vector3;new THREE.Vector3;return function(o){o.copy(r.position),t.copy(e),t.applyQuaternion(r.quaternion),o.add(t);var i=new THREE.Vector3(1,0).multiplyScalar(T.x);new THREE.Vector3(0,1,0).multiplyScalar(T.y);n.copy(i),n.applyQuaternion(r.quaternion)}}(),K=P,N=new THREE.Vector3,Z=new THREE.Vector3,$=new THREE.Quaternion,ee=new THREE.Quaternion,te=new THREE.Vector3(0,0,1),ne=new THREE.Vector3(0,0,1),oe=new THREE.Vector3,re=new THREE.Vector3,ie=new THREE.Vector3,ae=[];function ce(){return{position:new THREE.Vector3(N.x,N.y,N.z),normal:new THREE.Vector3(te.x,te.y,te.z),velocity:new THREE.Vector3(oe.x,oe.y,oe.z),width:K}}var le=.0025;function se(e){var t=new THREE.OctahedronGeometry(2,1),n=new THREE.MeshToonMaterial({wireframe:w.isWireframe}),o=new THREE.Mesh(t,n);o.position.set(e.position.x,e.position.y,e.position.z);var r=ce(),i=1;return w.applyVelocityMult&&(i=100*r.velocity.manhattanLength()),o.scale.set(le*i,le*i,le*i),alert(o.scale),o}function ue(){for(var e=0;e<I.length;++e)I[e]}function de(){if(w.drawSpheres){var e=se(ce());I.push(e),i.add(e)}if(!(q.length<M)){var t=q[q.length-2],n=q[q.length-1];t.position.distanceTo(n.position)<x?q.pop():(G[Q]&&i.remove(G[Q]),G[Q]=he(q),i.add(G[Q]))}}function pe(){if(_.push(ce()),!(_.length<S)){V&&(_.shift(),i.remove(V));var e=_[_.length-2],t=_[_.length-1];e.position.distanceTo(t.position)<x||(V=he(_),i.add(V))}}function he(e){for(var t,n=new Float32Array(2*e.length*3),o=new Float32Array(2*e.length*3),r=new Float32Array(2*e.length*2),i=new Float32Array(2*e.length*3),a=new THREE.Vector3,c=new THREE.Vector3,l=new THREE.Vector3,s=!1,u=0;u<e.length;u++){var d=e[u];if(a.crossVectors(d.normal,d.velocity),a.normalize(),a.multiplyScalar(d.width),t)t.dot(d.velocity)<0&&(s=!s);else t=new THREE.Vector3;t.copy(d.velocity),s?(c.addVectors(d.position,a),l.subVectors(d.position,a)):(c.subVectors(d.position,a),l.addVectors(d.position,a));var p=2*u*3;n[p]=c.x,n[p+1]=c.y,n[p+2]=c.z,n[p+3]=l.x,n[p+4]=l.y,n[p+5]=l.z,o[p=2*u*3]=d.normal.x,o[p+1]=d.normal.y,o[p+2]=d.normal.z,o[p+3]=d.normal.x,o[p+4]=d.normal.y,o[p+5]=d.normal.z,i[p=2*u*3]=d.velocity.x,i[p+1]=d.velocity.y,i[p+2]=d.velocity.z,i[p+3]=d.velocity.x,i[p+4]=d.velocity.y,i[p+5]=d.velocity.z,r[p=2*u*2]=u/(e.length-1),r[p+1]=0,r[p+2]=u/(e.length-1),r[p+3]=1}var E=new THREE.BufferGeometry;function y(){this.array=null}return E.addAttribute("position",new THREE.BufferAttribute(n,3).onUpload(y)),E.addAttribute("normal",new THREE.BufferAttribute(o,3).onUpload(y)),E.addAttribute("uv",new THREE.BufferAttribute(r,2).onUpload(y)),E.addAttribute("velocity",new THREE.BufferAttribute(i,3).onUpload(y)),E.computeBoundingSphere(),mesh=new THREE.Mesh(E,X),mesh.drawMode=THREE[h],mesh}function Ee(){ae.push(ie.length());var e=ae.length;if(e>U){for(var t=0,n=0;n<e;n++)t+=ae[n];t>L*U?(ae.length=0,we()):ae.shift()}}function ye(){F=!1,q.length=0,Q=0;for(var e=G.length,t=0;t<e;t++)i.remove(G[t])}function we(){F&&(F=!1,i.remove(G[Q]),q.length=0),Q-=1,i.remove(G[Q])}function fe(){Z.copy(N),ne.copy(te),ee.copy($),re.copy(oe),J(N),N.lerpVectors(Z,N,B),$.slerp(r.quaternion,D),te.set(0,0,1),te.applyQuaternion($),te.normalize(),te.lerpVectors(ne,te,k),oe.subVectors(N,Z),oe.lerpVectors(re,oe,C),ie.subVectors(oe,re),K=THREE.Math.lerp(K,oe.length()*j,z),K=Math.min(Math.max(K,P),O)}function ve(){a.clearColor(),n.render(),r.updateProjectionMatrix(),t.update(),fe(),b(ce().position),Ee(),F&&de(),ue(),a.clearDepth(),a.render(i,r),e.requestAnimationFrame(ve)}function me(){r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),a.setSize(window.innerWidth,window.innerHeight)}
},{"./math.rs":"z6L1"}],"FrRc":[function(require,module,exports) {
var t=null;function e(){return t||(t=n()),t}function n(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return r(t[0])}return"/"}function r(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)\/[^\/]+$/,"$1")+"/"}exports.getBundleURL=e,exports.getBaseURL=r;
},{}],"Cqla":[function(require,module,exports) {
var r=require("./bundle-url").getBundleURL;function e(r){Array.isArray(r)||(r=[r]);var e=r[r.length-1];try{return Promise.resolve(require(e))}catch(n){if("MODULE_NOT_FOUND"===n.code)return new s(function(n,i){t(r.slice(0,-1)).then(function(){return require(e)}).then(n,i)});throw n}}function t(r){return Promise.all(r.map(u))}var n={};function i(r,e){n[r]=e}module.exports=exports=e,exports.load=t,exports.register=i;var o={};function u(e){var t;if(Array.isArray(e)&&(t=e[1],e=e[0]),o[e])return o[e];var i=(e.substring(e.lastIndexOf(".")+1,e.length)||e).toLowerCase(),u=n[i];return u?o[e]=u(r()+e).then(function(r){return r&&module.bundle.register(t,r),r}).catch(function(r){throw delete o[e],r}):void 0}function s(r){this.executor=r,this.promise=null}s.prototype.then=function(r,e){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.then(r,e)},s.prototype.catch=function(r){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.catch(r)};
},{"./bundle-url":"FrRc"}],"Q7em":[function(require,module,exports) {
module.exports=function(t){return fetch(t).then(function(t){return WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(t):t.arrayBuffer().then(function(t){return WebAssembly.instantiate(t)})}).then(function(t){return t.instance.exports})};
},{}],0:[function(require,module,exports) {
var b=require("Cqla");b.register("wasm",require("Q7em"));b.load([["math.08aa8710.wasm","z6L1"]]).then(function(){require("Focm");});
},{}]},{},[0], null)
//# sourceMappingURL=/wasm-brush.b4a8f13e.js.map